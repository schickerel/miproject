<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="vendor/jquery-2.1.3.js"></script>
    <script src="vendor/d3.js"></script>
    <script src="vendor/topojson.js"></script>
    <!--datamaps has to be loaded last-->
    <script src="vendor/datamaps.world.min.js"></script>
</head>
<body>
<div id="container" style="position: relative; width: 1500px; height: 1200px;"></div>
<script type="text/javascript">

    var dataset = [

      {name: 'USA', count: 2000},
      {name: 'AFG', count: 2900}

         ];

//    var colorset = new Array();
//    calculateColor(dataset);

    //assign a specific color Value to a Country by using d3 function
    //maybe different colors for different values
    //see chloropleth article on Wikipedia for mor details
    var color = d3.scale.quantize()
            .range(['rgb(254,240,217)','rgb(253,212,158)','rgb(253,187,132)','rgb(252,141,89)','rgb(227,74,51)','rgb(179,0,0)'])
            .domain([d3.min(dataset, function(d) { return d['count']; }),
             d3.max(dataset, function(d) { return d['count']; })
             ]);


    var colorfunction = function (value){
           return color(value);
    }

    //console.log(d3.max(dataset, function(d) { return d['count']}));
    console.log(color(300));
    //get all countries
    var countries = Datamap.prototype.worldTopo.objects.world.geometries;
    //defining new constructor for datamap
    var buildCountryMap = function (dataset) {
        var countryMap = {};
        for(var countries in dataset) {
            var country = dataset[countries];
            countryMap[country['name']] = colorfunction(country['count']);

            console.log(country['count']);
        }
        return countryMap;
    };

    //get all countries
    var countries = Datamap.prototype.worldTopo.objects.world.geometries;
    //defining new constructor for datamap
    var map = new Datamap({
        element: document.getElementById('container'),
        fills: {
            defaultFill: "#000000"
        }
    });

    map.updateChoropleth(buildCountryMap(dataset));




   /* //using the country parameter to check values in the colorset array
    map.updateChoropleth({
            USA: calculation('USA'), AFG:calculation('AFG'), GBR:calculation('GBR')
        });



    function calculation(country){
        var color='rgba(23,48,210,0.9)';
        $.each(colorset, function(index, value){
            if (colorset[index].country == country ){
                color = colorset[index].colorcode;
                console.log(color);
                return color;
            }
        })
        return color;

    }


    //function for iteration over complete datamaps array
    var countries = Datamap.prototype.worldTopo.objects.world.geometries;
    $.each(countries, function( index, value ) {
        //console.log(countries[index].id, countries[index].properties.name)
        var country = countries[index].properties.name
    });


    function calculateColor(dataset) {
        $.each(dataset, function(index, value){
           var countryName = (dataset[index].name);
            var count = dataset[index].count;
            var color='';
            if (count>2001) {
               color = 'rgba(50,58,100,10)';
            }else{
                color = 'rgba(123,58,210,10)';
            }
            colorset.push( {country: countryName, colorcode: color } );
       })
        console.log(colorset);
    }*/









</script>
</body>
</html>