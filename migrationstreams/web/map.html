<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="js/jquery-2.1.3.js"></script>
    <script src="js/d3.js"></script>
    <script src="js/topojson.js"></script>
    <!--datamaps has to be loaded last-->
    <script src="js/datamaps.world.min.js"></script>
</head>
<body>
<div id="container" style="position: relative; width: 800px; height: 600px;"></div>
<script type="text/javascript">

    var dataset = [

      {name: 'USA', count: 2000},
      {name: 'AFG', count: 2900}

         ];

    var colorset = new Array();

    calculateColor(dataset);

    //get all countries
    var countries = Datamap.prototype.worldTopo.objects.world.geometries;
    //defining new constructor for datamap
    var map = new Datamap(

            //defining the attributes of the Datamap Object
            {element: document.getElementById('container'),//element in which datamap is embedded
             //fill color
                fills: {
                    defaultFill: 'rgba(23,48,210,0.9)' //any hex, color name or rgb/rgba value
                         },

                data: {

                }
            });




    //using the country parameter to check values in the colorset array
    map.updateChoropleth({
            USA: calculation('USA'), AFG:calculation('AFG')
        });



    function calculation(country){
        var color='';
        $.each(colorset, function(index, value){
            if (colorset[index].country == country ){
                color = colorset[index].colorcode;
                console.log(color);
                return color;
            }
        })
        return color;

    }


    //function for iteration over complete datamaps array
    var countries = Datamap.prototype.worldTopo.objects.world.geometries;
    $.each(countries, function( index, value ) {
        //console.log(countries[index].id, countries[index].properties.name)
        var country = countries[index].properties.name
    });


    function calculateColor(dataset) {
        $.each(dataset, function(index, value){
           var countryName = (dataset[index].name);
            var count = dataset[index].count;
            var color='';
            if (count>2001) {
               color = 'rgba(50,58,100,10)';
            }else{
                color = 'rgba(123,58,210,10)';
            }
            colorset.push( {country: countryName, colorcode: color } );
       })
        console.log(colorset);
    }

//        $.each(dataset, function(index, value ) {
//            console.log(dataset['name']);
//            var country = dataset['name'];
//            var count = dataset['count'];
//            if (count>2001) {
//                colorset['country'] = 'rgba(23,48,210,100)';
//            }else{
//                colorset['country'] = 'rgba(255,48,210,13)';
//            }
//        });





</script>
</body>
</html>